// // // // // // // // // // // 
//                             // 
//                             // 
// ofuscado e mas bonito skskks// 
//                             // 
// // // // // // // // // // //


const fs = require('fs');
const codeBase64 = `LyoKICogTUdYSVNOVVZFTSAtIFNpc3RlbWEgZGUgQW5vbmltYXRvIGNvbSBQcm94aWVzCiAqIFR1ZG8gZW0gdW0gw7puaWNvIGFycXVpdm8gZnVuY2lvbmFsCiAqLwoKLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQovLyBJTlNUQUxBw4fDg08gUsOBUElEQSBET1MgUEFDT1RFUyBORUNFU1PDgVJJT1MKLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQovKgpFeGVjdXRlIG5vIHRlcm1pbmFsOgpucG0gaW5zdGFsbCBheGlvcyBodHRwcy1wcm94eS1hZ2VudCBzb2Nrcy1wcm94eS1hZ2VudApPVQp5YXJuIGFkZCBheGlvcyBodHRwcy1wcm94eS1hZ2VudCBzb2Nrcy1wcm94eS1hZ2VudAoqLwoKY29uc3QgZnMgPSByZXF1aXJlKCdmcycpOwpjb25zdCBwYXRoID0gcmVxdWlyZSgncGF0aCcpOwpjb25zdCBheGlvcyA9IHJlcXVpcmUoJ2F4aW9zJyk7CmNvbnN0IHsgSHR0cHNQcm94eUFnZW50IH0gPSByZXF1aXJlKCdodHRwcy1wcm94eS1hZ2VudCcpOwpjb25zdCB7IFNvY2tzUHJveHlBZ2VudCB9ID0gcmVxdWlyZSgnc29ja3MtcHJveHktYWdlbnQnKTsKCi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KLy8gQ09ORklHVVJBw4fDg08gRE8gU0lTVEVNQQovLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CmNvbnN0IE1HWElTX0NPTkZJRyA9IHsKICAgIC8vIEZvbnRlcyBkZSBwcm94aWVzIGdyYXR1aXRhcyBlIGF0dWFsaXphZGFzCiAgICBQUk9YWV9TT1VSQ0VTOiBbCiAgICAgICAgJ2h0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9UaGVTcGVlZFgvUFJPWFktTGlzdC9tYXN0ZXIvaHR0cC50eHQnLAogICAgICAgICdodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vU2hpZnR5VFIvUHJveHktTGlzdC9tYXN0ZXIvaHR0cC50eHQnLAogICAgICAgICdodHRwczovL2FwaS5wcm94eXNjcmFwZS5jb20vdjIvP3JlcXVlc3Q9Z2V0cHJveGllcyZwcm90b2NvbD1odHRwJnRpbWVvdXQ9NTAwMCcsCiAgICAgICAgJ2h0dHBzOi8vd3d3LnByb3h5LWxpc3QuZG93bmxvYWQvYXBpL3YxL2dldD90eXBlPWh0dHAnLAogICAgICAgICdodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vbW9ub3NhbnMvcHJveHktbGlzdC9tYWluL3Byb3hpZXMvaHR0cC50eHQnCiAgICBdLAogICAgCiAgICAvLyBDb25maWd1cmHDp8O1ZXMgZGUgdGVzdGUKICAgIFRFU1RfVElNRU9VVDogODAwMCwKICAgIFRFU1RfVVJMUzogWwogICAgICAgICdodHRwOi8vaHR0cGJpbi5vcmcvaXAnLAogICAgICAgICdodHRwOi8vaXAtYXBpLmNvbS9qc29uJywKICAgICAgICAnaHR0cHM6Ly9hcGkubXlpcC5jb20nCiAgICBdLAogICAgCiAgICAvLyBTaXN0ZW1hIGRlIHJvdGHDp8OjbwogICAgQVVUT19ST1RBVElPTjogdHJ1ZSwKICAgIFJPVEFUSU9OX1RJTUU6IDkwMDAwLCAvLyA5MCBzZWd1bmRvcwogICAgTUFYX1JFVFJJRVM6IDMsCiAgICAKICAgIC8vIEFnZW50ZXMgZGUgdXN1w6FyaW8gcmVhbGlzdGFzCiAgICBVU0VSX0FHRU5UUzogWwogICAgICAgICdNb3ppbGxhLzUuMCAoV2luZG93cyBOVCAxMC4wOyBXaW42NDsgeDY0KSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBDaHJvbWUvMTIxLjAuMC4wIFNhZmFyaS81MzcuMzYnLAogICAgICAgICdNb3ppbGxhLzUuMCAoV2luZG93cyBOVCAxMC4wOyBXaW42NDsgeDY0OyBydjoxMjIuMCkgR2Vja28vMjAxMDAxMDEgRmlyZWZveC8xMjIuMCcsCiAgICAgICAgJ01vemlsbGEvNS4wIChNYWNpbnRvc2g7IEludGVsIE1hYyBPUyBYIDEwXzE1XzcpIEFwcGxlV2ViS2l0LzYwNS4xLjE1IChLSFRNTCwgbGlrZSBHZWNrbykgVmVyc2lvbi8xNy4zIFNhZmFyaS82MDUuMS4xNScsCiAgICAgICAgJ01vemlsbGEvNS4wIChYMTE7IExpbnV4IHg4Nl82NCkgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzEyMS4wLjAuMCBTYWZhcmkvNTM3LjM2JwogICAgXSwKICAgIAogICAgLy8gQ2FtaW5ob3MgZG9zIGFycXVpdm9zCiAgICBEQVRBX0RJUjogJy4vbWd4aXNfZGF0YScsCiAgICBGSUxFUzogewogICAgICAgIFBST1hJRVM6ICdwcm94aWVzX2xpc3QudHh0JywKICAgICAgICBXT1JLSU5HOiAnd29ya2luZ19wcm94aWVzLnR4dCcsCiAgICAgICAgQkxBQ0tMSVNUOiAnYmxhY2tsaXN0LnR4dCcsCiAgICAgICAgTE9HUzogJ3N5c3RlbS5sb2cnCiAgICB9Cn07CgovLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ci8vIENMQVNTRSBQUklOQ0lQQUwgTUdYSVNOVVZFTQovLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CmNsYXNzIE1HWElTTnV2ZW0gewogICAgY29uc3RydWN0b3Iob3B0aW9ucyA9IHt9KSB7CiAgICAgICAgLy8gTWVzY2xhIGNvbmZpZ3VyYcOnw7VlcyBwYWRyw6NvIGNvbSBwZXJzb25hbGl6YWRhcwogICAgICAgIHRoaXMuY29uZmlnID0geyAuLi5NR1hJU19DT05GSUcsIC4uLm9wdGlvbnMgfTsKICAgICAgICAKICAgICAgICAvLyBFc3RhZG8gZG8gc2lzdGVtYQogICAgICAgIHRoaXMucHJveHlMaXN0ID0gW107CiAgICAgICAgdGhpcy53b3JraW5nUHJveGllcyA9IFtdOwogICAgICAgIHRoaXMuYmxhY2tsaXN0ID0gbmV3IFNldCgpOwogICAgICAgIHRoaXMuY3VycmVudFByb3h5ID0gbnVsbDsKICAgICAgICB0aGlzLmFjdGl2ZSA9IGZhbHNlOwogICAgICAgIHRoaXMucm90YXRpb25UaW1lciA9IG51bGw7CiAgICAgICAgCiAgICAgICAgLy8gRXN0YXTDrXN0aWNhcwogICAgICAgIHRoaXMuc3RhdHMgPSB7CiAgICAgICAgICAgIHByb3hpZXNMb2FkZWQ6IDAsCiAgICAgICAgICAgIHByb3hpZXNUZXN0ZWQ6IDAsCiAgICAgICAgICAgIHByb3hpZXNXb3JraW5nOiAwLAogICAgICAgICAgICByZXF1ZXN0c01hZGU6IDAsCiAgICAgICAgICAgIGxhc3RSb3RhdGlvbjogbnVsbCwKICAgICAgICAgICAgc3RhcnRUaW1lOiBuZXcgRGF0ZSgpCiAgICAgICAgfTsKICAgICAgICAKICAgICAgICAvLyBJbmljaWFsaXphw6fDo28KICAgICAgICB0aGlzLmluaXRpYWxpemVTeXN0ZW0oKTsKICAgIH0KICAgIAogICAgLy8gSW5pY2lhbGl6YSBvIHNpc3RlbWEKICAgIGluaXRpYWxpemVTeXN0ZW0oKSB7CiAgICAgICAgY29uc29sZS5sb2coJ1tNR1hJU05VVkVNXSBJbmljaWFuZG8gc2lzdGVtYS4uLicpOwogICAgICAgIAogICAgICAgIC8vIENyaWEgZGlyZXTDs3JpbyBkZSBkYWRvcwogICAgICAgIGlmICghZnMuZXhpc3RzU3luYyh0aGlzLmNvbmZpZy5EQVRBX0RJUikpIHsKICAgICAgICAgICAgZnMubWtkaXJTeW5jKHRoaXMuY29uZmlnLkRBVEFfRElSLCB7IHJlY3Vyc2l2ZTogdHJ1ZSB9KTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgLy8gQ2FycmVnYSBkYWRvcyBleGlzdGVudGVzCiAgICAgICAgdGhpcy5sb2FkU2F2ZWREYXRhKCk7CiAgICAgICAgCiAgICAgICAgLy8gQ29uZmlndXJhIGhhbmRsZXJzIGRlIGVuY2VycmFtZW50bwogICAgICAgIHRoaXMuc2V0dXBTaHV0ZG93bkhhbmRsZXJzKCk7CiAgICAgICAgCiAgICAgICAgY29uc29sZS5sb2coJ1tNR1hJU05VVkVNXSBTaXN0ZW1hIHByb250byBwYXJhIHVzbycpOwogICAgfQogICAgCiAgICAvLyBDYXJyZWdhIGRhZG9zIHNhbHZvcwogICAgbG9hZFNhdmVkRGF0YSgpIHsKICAgICAgICBjb25zdCBwcm94eUZpbGUgPSBwYXRoLmpvaW4odGhpcy5jb25maWcuREFUQV9ESVIsIHRoaXMuY29uZmlnLkZJTEVTLlBST1hJRVMpOwogICAgICAgIGNvbnN0IHdvcmtpbmdGaWxlID0gcGF0aC5qb2luKHRoaXMuY29uZmlnLkRBVEFfRElSLCB0aGlzLmNvbmZpZy5GSUxFUy5XT1JLSU5HKTsKICAgICAgICBjb25zdCBibGFja2xpc3RGaWxlID0gcGF0aC5qb2luKHRoaXMuY29uZmlnLkRBVEFfRElSLCB0aGlzLmNvbmZpZy5GSUxFUy5CTEFDS0xJU1QpOwogICAgICAgIAogICAgICAgIC8vIENhcnJlZ2EgbGlzdGEgZ2VyYWwgZGUgcHJveGllcwogICAgICAgIGlmIChmcy5leGlzdHNTeW5jKHByb3h5RmlsZSkpIHsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIGNvbnN0IGNvbnRlbnQgPSBmcy5yZWFkRmlsZVN5bmMocHJveHlGaWxlLCAndXRmOCcpOwogICAgICAgICAgICAgICAgdGhpcy5wcm94eUxpc3QgPSBjb250ZW50LnNwbGl0KCdcbicpCiAgICAgICAgICAgICAgICAgICAgLm1hcChsaW5lID0+IGxpbmUudHJpbSgpKQogICAgICAgICAgICAgICAgICAgIC5maWx0ZXIobGluZSA9PiBsaW5lICYmICFsaW5lLnN0YXJ0c1dpdGgoJyMnKSAmJiBsaW5lLmluY2x1ZGVzKCc6JykpOwogICAgICAgICAgICAgICAgdGhpcy5zdGF0cy5wcm94aWVzTG9hZGVkID0gdGhpcy5wcm94eUxpc3QubGVuZ3RoOwogICAgICAgICAgICAgICAgY29uc29sZS5sb2coYFtNR1hJU05VVkVNXSAke3RoaXMucHJveHlMaXN0Lmxlbmd0aH0gcHJveGllcyBjYXJyZWdhZG9zIGRvIGFycXVpdm9gKTsKICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1tNR1hJU05VVkVNXSBFcnJvIGFvIGNhcnJlZ2FyIHByb3hpZXM6JywgZXJyb3IubWVzc2FnZSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgCiAgICAgICAgLy8gQ2FycmVnYSBwcm94aWVzIGZ1bmNpb25haXMKICAgICAgICBpZiAoZnMuZXhpc3RzU3luYyh3b3JraW5nRmlsZSkpIHsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIGNvbnN0IGNvbnRlbnQgPSBmcy5yZWFkRmlsZVN5bmMod29ya2luZ0ZpbGUsICd1dGY4Jyk7CiAgICAgICAgICAgICAgICB0aGlzLndvcmtpbmdQcm94aWVzID0gY29udGVudC5zcGxpdCgnXG4nKQogICAgICAgICAgICAgICAgICAgIC5maWx0ZXIobGluZSA9PiBsaW5lLnRyaW0oKSk7CiAgICAgICAgICAgICAgICB0aGlzLnN0YXRzLnByb3hpZXNXb3JraW5nID0gdGhpcy53b3JraW5nUHJveGllcy5sZW5ndGg7CiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdbTUdYSVNOVVZFTV0gRXJybyBhbyBjYXJyZWdhciB3b3JraW5nIHByb3hpZXM6JywgZXJyb3IubWVzc2FnZSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgCiAgICAgICAgLy8gQ2FycmVnYSBibGFja2xpc3QKICAgICAgICBpZiAoZnMuZXhpc3RzU3luYyhibGFja2xpc3RGaWxlKSkgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgY29uc3QgY29udGVudCA9IGZzLnJlYWRGaWxlU3luYyhibGFja2xpc3RGaWxlLCAndXRmOCcpOwogICAgICAgICAgICAgICAgY29udGVudC5zcGxpdCgnXG4nKS5mb3JFYWNoKHByb3h5ID0+IHsKICAgICAgICAgICAgICAgICAgICBpZiAocHJveHkudHJpbSgpKSB0aGlzLmJsYWNrbGlzdC5hZGQocHJveHkudHJpbSgpKTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgY29uc29sZS5sb2coYFtNR1hJU05VVkVNXSAke3RoaXMuYmxhY2tsaXN0LnNpemV9IHByb3hpZXMgbmEgYmxhY2tsaXN0YCk7CiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdbTUdYSVNOVVZFTV0gRXJybyBhbyBjYXJyZWdhciBibGFja2xpc3Q6JywgZXJyb3IubWVzc2FnZSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CiAgICAKICAgIC8vIENvbmZpZ3VyYSBoYW5kbGVycyBwYXJhIGRlc2xpZ2FtZW50bwogICAgc2V0dXBTaHV0ZG93bkhhbmRsZXJzKCkgewogICAgICAgIGNvbnN0IHNodXRkb3duID0gKCkgPT4gewogICAgICAgICAgICBjb25zb2xlLmxvZygnXG5bTUdYSVNOVVZFTV0gRW5jZXJyYW5kbyBzaXN0ZW1hLi4uJyk7CiAgICAgICAgICAgIHRoaXMuc3RvcFJvdGF0aW9uKCk7CiAgICAgICAgICAgIHRoaXMuc2F2ZURhdGEoKTsKICAgICAgICAgICAgcHJvY2Vzcy5leGl0KDApOwogICAgICAgIH07CiAgICAgICAgCiAgICAgICAgcHJvY2Vzcy5vbignU0lHSU5UJywgc2h1dGRvd24pOwogICAgICAgIHByb2Nlc3Mub24oJ1NJR1RFUk0nLCBzaHV0ZG93bik7CiAgICB9CiAgICAKICAgIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KICAgIC8vIEZVTsOHw5VFUyBERSBCVVNDQSBERSBQUk9YSUVTCiAgICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiAgICAKICAgIC8vIEJ1c2NhIHByb3hpZXMgZGFzIGZvbnRlcyBjb25maWd1cmFkYXMKICAgIGFzeW5jIGZldGNoUHJveGllcygpIHsKICAgICAgICBjb25zb2xlLmxvZygnW01HWElTTlVWRU1dIEJ1c2NhbmRvIHByb3hpZXMgYXR1YWxpemFkb3MuLi4nKTsKICAgICAgICAKICAgICAgICBjb25zdCBhbGxQcm94aWVzID0gbmV3IFNldCgpOwogICAgICAgIAogICAgICAgIGZvciAoY29uc3Qgc291cmNlIG9mIHRoaXMuY29uZmlnLlBST1hZX1NPVVJDRVMpIHsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGAgIC0+IEJ1c2NhbmRvIGRlOiAke3NvdXJjZX1gKTsKICAgICAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgYXhpb3MuZ2V0KHNvdXJjZSwgeyAKICAgICAgICAgICAgICAgICAgICB0aW1lb3V0OiB0aGlzLmNvbmZpZy5URVNUX1RJTUVPVVQgCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgY29uc3QgcHJveGllcyA9IHJlc3BvbnNlLmRhdGEKICAgICAgICAgICAgICAgICAgICAuc3BsaXQoJ1xuJykKICAgICAgICAgICAgICAgICAgICAubWFwKGxpbmUgPT4gbGluZS50cmltKCkpCiAgICAgICAgICAgICAgICAgICAgLmZpbHRlcihsaW5lID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgLy8gRmlsdHJhIGFwZW5hcyBsaW5oYXMgdsOhbGlkYXMKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGxpbmUgJiYgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAhbGluZS5zdGFydHNXaXRoKCcjJykgJiYgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAhbGluZS5zdGFydHNXaXRoKCcvLycpICYmCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5lLmluY2x1ZGVzKCc6JykgJiYKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC9eWzAtOV0rXC5bMC05XStcLlswLTldK1wuWzAtOV0rOlswLTldKyQvLnRlc3QobGluZSk7CiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICAubWFwKGxpbmUgPT4gewogICAgICAgICAgICAgICAgICAgICAgICAvLyBDb252ZXJ0ZSBwYXJhIGZvcm1hdG8gSFRUUCBwYWRyw6NvCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IFtob3N0LCBwb3J0XSA9IGxpbmUuc3BsaXQoJzonKTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGBodHRwOi8vJHtob3N0fToke3BvcnR9YDsKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgcHJveGllcy5mb3JFYWNoKHByb3h5ID0+IGFsbFByb3hpZXMuYWRkKHByb3h5KSk7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgICAgICDinJMgJHtwcm94aWVzLmxlbmd0aH0gZW5jb250cmFkb3NgKTsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgICAgICAgICAgY29uc29sZS5sb2coYCAgICAg4pyXIEVycm86ICR7ZXJyb3IubWVzc2FnZX1gKTsKICAgICAgICAgICAgfQogICAgICAgICAgICAKICAgICAgICAgICAgLy8gUGVxdWVuYSBwYXVzYSBlbnRyZSByZXF1ZXN0cwogICAgICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgMTAwMCkpOwogICAgICAgIH0KICAgICAgICAKICAgICAgICB0aGlzLnByb3h5TGlzdCA9IEFycmF5LmZyb20oYWxsUHJveGllcyk7CiAgICAgICAgdGhpcy5zdGF0cy5wcm94aWVzTG9hZGVkID0gdGhpcy5wcm94eUxpc3QubGVuZ3RoOwogICAgICAgIAogICAgICAgIGNvbnNvbGUubG9nKGBbTUdYSVNOVVZFTV0gVG90YWwgZGUgcHJveGllcyDDum5pY29zOiAke3RoaXMucHJveHlMaXN0Lmxlbmd0aH1gKTsKICAgICAgICAKICAgICAgICAvLyBTYWx2YSBubyBhcnF1aXZvCiAgICAgICAgdGhpcy5zYXZlUHJveGllc1RvRmlsZSgpOwogICAgICAgIAogICAgICAgIHJldHVybiB0aGlzLnByb3h5TGlzdDsKICAgIH0KICAgIAogICAgLy8gU2FsdmEgcHJveGllcyBubyBhcnF1aXZvCiAgICBzYXZlUHJveGllc1RvRmlsZSgpIHsKICAgICAgICB0cnkgewogICAgICAgICAgICBjb25zdCBmaWxlUGF0aCA9IHBhdGguam9pbih0aGlzLmNvbmZpZy5EQVRBX0RJUiwgdGhpcy5jb25maWcuRklMRVMuUFJPWElFUyk7CiAgICAgICAgICAgIGNvbnN0IGNvbnRlbnQgPSB0aGlzLnByb3h5TGlzdC5qb2luKCdcbicpOwogICAgICAgICAgICBmcy53cml0ZUZpbGVTeW5jKGZpbGVQYXRoLCBjb250ZW50LCAndXRmOCcpOwogICAgICAgICAgICBjb25zb2xlLmxvZyhgW01HWElTTlVWRU1dIFByb3hpZXMgc2Fsdm9zIGVtOiAke2ZpbGVQYXRofWApOwogICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1tNR1hJU05VVkVNXSBFcnJvIGFvIHNhbHZhciBwcm94aWVzOicsIGVycm9yLm1lc3NhZ2UpOwogICAgICAgIH0KICAgIH0KICAgIAogICAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQogICAgLy8gRlVOw4fDlUVTIERFIFRFU1RFIERFIFBST1hJRVMKICAgIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KICAgIAogICAgLy8gRGV0ZWN0YSB0aXBvIGRlIHByb3h5CiAgICBkZXRlY3RQcm94eVR5cGUocHJveHlVcmwpIHsKICAgICAgICBpZiAocHJveHlVcmwuaW5jbHVkZXMoJ3NvY2tzNDovLycpIHx8IHByb3h5VXJsLmluY2x1ZGVzKCdzb2NrczU6Ly8nKSkgewogICAgICAgICAgICByZXR1cm4gJ3NvY2tzJzsKICAgICAgICB9CiAgICAgICAgcmV0dXJuICdodHRwJzsKICAgIH0KICAgIAogICAgLy8gQ3JpYSBhZ2VudGUgYmFzZWFkbyBubyB0aXBvIGRlIHByb3h5CiAgICBjcmVhdGVQcm94eUFnZW50KHByb3h5VXJsKSB7CiAgICAgICAgY29uc3QgcHJveHlUeXBlID0gdGhpcy5kZXRlY3RQcm94eVR5cGUocHJveHlVcmwpOwogICAgICAgIAogICAgICAgIGlmIChwcm94eVR5cGUgPT09ICdzb2NrcycpIHsKICAgICAgICAgICAgcmV0dXJuIG5ldyBTb2Nrc1Byb3h5QWdlbnQocHJveHlVcmwpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJldHVybiBuZXcgSHR0cHNQcm94eUFnZW50KHByb3h5VXJsKTsKICAgICAgICB9CiAgICB9CiAgICAKICAgIC8vIFRlc3RhIHVtIHByb3h5IGluZGl2aWR1YWwKICAgIGFzeW5jIHRlc3RQcm94eShwcm94eVVybCkgewogICAgICAgIC8vIFB1bGEgc2UgZXN0aXZlciBuYSBibGFja2xpc3QKICAgICAgICBpZiAodGhpcy5ibGFja2xpc3QuaGFzKHByb3h5VXJsKSkgewogICAgICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdCbGFja2xpc3RlZCcgfTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgY29uc3QgYWdlbnQgPSB0aGlzLmNyZWF0ZVByb3h5QWdlbnQocHJveHlVcmwpOwogICAgICAgIGNvbnN0IHVzZXJBZ2VudCA9IHRoaXMuY29uZmlnLlVTRVJfQUdFTlRTW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIHRoaXMuY29uZmlnLlVTRVJfQUdFTlRTLmxlbmd0aCldOwogICAgICAgIAogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGNvbnN0IHN0YXJ0VGltZSA9IERhdGUubm93KCk7CiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgYXhpb3MuZ2V0KHRoaXMuY29uZmlnLlRFU1RfVVJMU1swXSwgewogICAgICAgICAgICAgICAgaHR0cHNBZ2VudDogYWdlbnQsCiAgICAgICAgICAgICAgICB0aW1lb3V0OiB0aGlzLmNvbmZpZy5URVNUX1RJTUVPVVQsCiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgICAgICAgJ1VzZXItQWdlbnQnOiB1c2VyQWdlbnQsCiAgICAgICAgICAgICAgICAgICAgJ0FjY2VwdCc6ICdhcHBsaWNhdGlvbi9qc29uLHRleHQvaHRtbCcsCiAgICAgICAgICAgICAgICAgICAgJ0Nvbm5lY3Rpb24nOiAna2VlcC1hbGl2ZScKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlVGltZSA9IERhdGUubm93KCkgLSBzdGFydFRpbWU7CiAgICAgICAgICAgIAogICAgICAgICAgICB0aGlzLnN0YXRzLnByb3hpZXNUZXN0ZWQrKzsKICAgICAgICAgICAgCiAgICAgICAgICAgIC8vIFZlcmlmaWNhIHNlIGEgcmVzcG9zdGEgw6kgdsOhbGlkYQogICAgICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID49IDIwMCAmJiByZXNwb25zZS5zdGF0dXMgPCAzMDApIHsKICAgICAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICBwcm94eTogcHJveHlVcmwsCiAgICAgICAgICAgICAgICAgICAgcmVzcG9uc2VUaW1lOiByZXNwb25zZVRpbWUsCiAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiByZXNwb25zZS5zdGF0dXMsCiAgICAgICAgICAgICAgICAgICAgZGF0YTogcmVzcG9uc2UuZGF0YSwKICAgICAgICAgICAgICAgICAgICB0ZXN0ZWRBdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpCiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICB9CiAgICAgICAgICAgIAogICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFN0YXR1cyAke3Jlc3BvbnNlLnN0YXR1c31gKTsKICAgICAgICAgICAgCiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICAgICAgdGhpcy5zdGF0cy5wcm94aWVzVGVzdGVkKys7CiAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSwKICAgICAgICAgICAgICAgIHByb3h5OiBwcm94eVVybCwKICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvci5tZXNzYWdlLAogICAgICAgICAgICAgICAgdGVzdGVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKQogICAgICAgICAgICB9OwogICAgICAgIH0KICAgIH0KICAgIAogICAgLy8gVGVzdGEgbcO6bHRpcGxvcyBwcm94aWVzCiAgICBhc3luYyB0ZXN0TXVsdGlwbGVQcm94aWVzKHByb3hpZXMsIG1heENvbmN1cnJlbnQgPSA1KSB7CiAgICAgICAgY29uc29sZS5sb2coYFtNR1hJU05VVkVNXSBUZXN0YW5kbyAke3Byb3hpZXMubGVuZ3RofSBwcm94aWVzLi4uYCk7CiAgICAgICAgCiAgICAgICAgY29uc3QgcmVzdWx0cyA9IFtdOwogICAgICAgIGNvbnN0IHdvcmtpbmcgPSBbXTsKICAgICAgICAKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHByb3hpZXMubGVuZ3RoOyBpICs9IG1heENvbmN1cnJlbnQpIHsKICAgICAgICAgICAgY29uc3QgYmF0Y2ggPSBwcm94aWVzLnNsaWNlKGksIGkgKyBtYXhDb25jdXJyZW50KTsKICAgICAgICAgICAgY29uc3QgYmF0Y2hQcm9taXNlcyA9IGJhdGNoLm1hcChwcm94eSA9PiB0aGlzLnRlc3RQcm94eShwcm94eSkpOwogICAgICAgICAgICAKICAgICAgICAgICAgY29uc3QgYmF0Y2hSZXN1bHRzID0gYXdhaXQgUHJvbWlzZS5hbGwoYmF0Y2hQcm9taXNlcyk7CiAgICAgICAgICAgIHJlc3VsdHMucHVzaCguLi5iYXRjaFJlc3VsdHMpOwogICAgICAgICAgICAKICAgICAgICAgICAgLy8gQWRpY2lvbmEgb3MgcXVlIGZ1bmNpb25hcmFtIMOgIGxpc3RhCiAgICAgICAgICAgIGJhdGNoUmVzdWx0cy5mb3JFYWNoKHJlc3VsdCA9PiB7CiAgICAgICAgICAgICAgICBpZiAocmVzdWx0LnN1Y2Nlc3MpIHsKICAgICAgICAgICAgICAgICAgICB3b3JraW5nLnB1c2gocmVzdWx0KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIAogICAgICAgICAgICAvLyBNb3N0cmEgcHJvZ3Jlc3NvCiAgICAgICAgICAgIGNvbnN0IHByb2Nlc3NlZCA9IE1hdGgubWluKGkgKyBtYXhDb25jdXJyZW50LCBwcm94aWVzLmxlbmd0aCk7CiAgICAgICAgICAgIGNvbnN0IHBlcmNlbnQgPSAoKHByb2Nlc3NlZCAvIHByb3hpZXMubGVuZ3RoKSAqIDEwMCkudG9GaXhlZCgxKTsKICAgICAgICAgICAgY29uc29sZS5sb2coYCAgUHJvZ3Jlc3NvOiAke3Byb2Nlc3NlZH0vJHtwcm94aWVzLmxlbmd0aH0gKCR7cGVyY2VudH0lKSAtICR7d29ya2luZy5sZW5ndGh9IGZ1bmNpb25hbmRvYCk7CiAgICAgICAgICAgIAogICAgICAgICAgICAvLyBQZXF1ZW5hIHBhdXNhIHBhcmEgZXZpdGFyIHJhdGUgbGltaXRpbmcKICAgICAgICAgICAgYXdhaXQgbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIDUwMCkpOwogICAgICAgIH0KICAgICAgICAKICAgICAgICAvLyBBdHVhbGl6YSBlc3RhdMOtc3RpY2FzCiAgICAgICAgdGhpcy5zdGF0cy5wcm94aWVzV29ya2luZyA9IHdvcmtpbmcubGVuZ3RoOwogICAgICAgIAogICAgICAgIC8vIE9yZGVuYSBwb3IgdmVsb2NpZGFkZSAobWFpcyByw6FwaWRvIHByaW1laXJvKQogICAgICAgIHdvcmtpbmcuc29ydCgoYSwgYikgPT4gYS5yZXNwb25zZVRpbWUgLSBiLnJlc3BvbnNlVGltZSk7CiAgICAgICAgdGhpcy53b3JraW5nUHJveGllcyA9IHdvcmtpbmcubWFwKHJlc3VsdCA9PiByZXN1bHQucHJveHkpOwogICAgICAgIAogICAgICAgIGNvbnNvbGUubG9nKGBbTUdYSVNOVVZFTV0gJHt3b3JraW5nLmxlbmd0aH0gZGUgJHtwcm94aWVzLmxlbmd0aH0gcHJveGllcyBlc3TDo28gZnVuY2lvbmFuZG9gKTsKICAgICAgICAKICAgICAgICAvLyBTYWx2YSB3b3JraW5nIHByb3hpZXMKICAgICAgICB0aGlzLnNhdmVXb3JraW5nUHJveGllcygpOwogICAgICAgIAogICAgICAgIHJldHVybiB3b3JraW5nOwogICAgfQogICAgCiAgICAvLyBTYWx2YSB3b3JraW5nIHByb3hpZXMKICAgIHNhdmVXb3JraW5nUHJveGllcygpIHsKICAgICAgICB0cnkgewogICAgICAgICAgICBjb25zdCBmaWxlUGF0aCA9IHBhdGguam9pbih0aGlzLmNvbmZpZy5EQVRBX0RJUiwgdGhpcy5jb25maWcuRklMRVMuV09SS0lORyk7CiAgICAgICAgICAgIGNvbnN0IGNvbnRlbnQgPSB0aGlzLndvcmtpbmdQcm94aWVzLmpvaW4oJ1xuJyk7CiAgICAgICAgICAgIGZzLndyaXRlRmlsZVN5bmMoZmlsZVBhdGgsIGNvbnRlbnQsICd1dGY4Jyk7CiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICAgICAgY29uc29sZS5lcnJvcignW01HWElTTlVWRU1dIEVycm8gYW8gc2FsdmFyIHdvcmtpbmcgcHJveGllczonLCBlcnJvci5tZXNzYWdlKTsKICAgICAgICB9CiAgICB9CiAgICAKICAgIC8vIEFkaWNpb25hIHByb3h5IMOgIGJsYWNrbGlzdAogICAgYmxhY2tsaXN0UHJveHkocHJveHlVcmwpIHsKICAgICAgICB0aGlzLmJsYWNrbGlzdC5hZGQocHJveHlVcmwpOwogICAgICAgIAogICAgICAgIC8vIFJlbW92ZSBkYSBsaXN0YSBkZSB3b3JraW5nIHNlIGVzdGl2ZXIgbMOhCiAgICAgICAgY29uc3QgaW5kZXggPSB0aGlzLndvcmtpbmdQcm94aWVzLmluZGV4T2YocHJveHlVcmwpOwogICAgICAgIGlmIChpbmRleCA+IC0xKSB7CiAgICAgICAgICAgIHRoaXMud29ya2luZ1Byb3hpZXMuc3BsaWNlKGluZGV4LCAxKTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgLy8gU2FsdmEgYmxhY2tsaXN0CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgY29uc3QgZmlsZVBhdGggPSBwYXRoLmpvaW4odGhpcy5jb25maWcuREFUQV9ESVIsIHRoaXMuY29uZmlnLkZJTEVTLkJMQUNLTElTVCk7CiAgICAgICAgICAgIGZzLmFwcGVuZEZpbGVTeW5jKGZpbGVQYXRoLCBgJHtwcm94eVVybH1cbmAsICd1dGY4Jyk7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKGBbTUdYSVNOVVZFTV0gUHJveHkgYmxhY2tsaXN0ZWQ6ICR7cHJveHlVcmx9YCk7CiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICAgICAgY29uc29sZS5lcnJvcignW01HWElTTlVWRU1dIEVycm8gYW8gc2FsdmFyIGJsYWNrbGlzdDonLCBlcnJvci5tZXNzYWdlKTsKICAgICAgICB9CiAgICB9CiAgICAKICAgIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KICAgIC8vIFNJU1RFTUEgREUgUk9UQcOHw4NPCiAgICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiAgICAKICAgIC8vIEluaWNpYSByb3Rhw6fDo28gYXV0b23DoXRpY2EKICAgIHN0YXJ0Um90YXRpb24oKSB7CiAgICAgICAgaWYgKHRoaXMuYWN0aXZlKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdbTUdYSVNOVVZFTV0gUm90YcOnw6NvIGrDoSBlc3TDoSBhdGl2YScpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIAogICAgICAgIGlmICh0aGlzLndvcmtpbmdQcm94aWVzLmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgICBjb25zb2xlLmxvZygnW01HWElTTlVWRU1dIE5lbmh1bSBwcm94eSBmdW5jaW9uYWwgcGFyYSByb3RhY2lvbmFyJyk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgdGhpcy5hY3RpdmUgPSB0cnVlOwogICAgICAgIGNvbnNvbGUubG9nKGBbTUdYSVNOVVZFTV0gUm90YcOnw6NvIGluaWNpYWRhICgke3RoaXMuY29uZmlnLlJPVEFUSU9OX1RJTUUvMTAwMH1zIGVudHJlIHRyb2NhcylgKTsKICAgICAgICAKICAgICAgICAvLyBQcmltZWlyYSByb3Rhw6fDo28KICAgICAgICB0aGlzLnJvdGF0ZVByb3h5KCk7CiAgICAgICAgCiAgICAgICAgLy8gQ29uZmlndXJhIGludGVydmFsbwogICAgICAgIHRoaXMucm90YXRpb25UaW1lciA9IHNldEludGVydmFsKCgpID0+IHsKICAgICAgICAgICAgdGhpcy5yb3RhdGVQcm94eSgpOwogICAgICAgIH0sIHRoaXMuY29uZmlnLlJPVEFUSU9OX1RJTUUpOwogICAgfQogICAgCiAgICAvLyBQYXJhIHJvdGHDp8OjbwogICAgc3RvcFJvdGF0aW9uKCkgewogICAgICAgIGlmICh0aGlzLnJvdGF0aW9uVGltZXIpIHsKICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLnJvdGF0aW9uVGltZXIpOwogICAgICAgICAgICB0aGlzLnJvdGF0aW9uVGltZXIgPSBudWxsOwogICAgICAgIH0KICAgICAgICAKICAgICAgICB0aGlzLmFjdGl2ZSA9IGZhbHNlOwogICAgICAgIGNvbnNvbGUubG9nKCdbTUdYSVNOVVZFTV0gUm90YcOnw6NvIHBhcmFkYScpOwogICAgfQogICAgCiAgICAvLyBSb3RhY2lvbmEgcGFyYSBwcsOzeGltbyBwcm94eQogICAgcm90YXRlUHJveHkoKSB7CiAgICAgICAgaWYgKHRoaXMud29ya2luZ1Byb3hpZXMubGVuZ3RoID09PSAwKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdbTUdYSVNOVVZFTV0gTmVuaHVtIHByb3h5IGRpc3BvbsOtdmVsIHBhcmEgcm90YcOnw6NvJyk7CiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIH0KICAgICAgICAKICAgICAgICAvLyBTZWxlY2lvbmEgcHJveHkgbWFpcyByw6FwaWRvIG91IGFsZWF0w7NyaW8KICAgICAgICBsZXQgbmV4dFByb3h5OwogICAgICAgIGlmIChNYXRoLnJhbmRvbSgpID4gMC43KSB7IC8vIDMwJSBkZSBjaGFuY2UgZGUgcGVnYXIgYWxlYXTDs3JpbwogICAgICAgICAgICBjb25zdCByYW5kb21JbmRleCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIHRoaXMud29ya2luZ1Byb3hpZXMubGVuZ3RoKTsKICAgICAgICAgICAgbmV4dFByb3h5ID0gdGhpcy53b3JraW5nUHJveGllc1tyYW5kb21JbmRleF07CiAgICAgICAgfSBlbHNlIHsgLy8gNzAlIHBlZ2EgbyBtYWlzIHLDoXBpZG8gKHByaW1laXJvIGRhIGxpc3RhKQogICAgICAgICAgICBuZXh0UHJveHkgPSB0aGlzLndvcmtpbmdQcm94aWVzWzBdOwogICAgICAgIH0KICAgICAgICAKICAgICAgICB0aGlzLmN1cnJlbnRQcm94eSA9IG5leHRQcm94eTsKICAgICAgICB0aGlzLnN0YXRzLmxhc3RSb3RhdGlvbiA9IG5ldyBEYXRlKCk7CiAgICAgICAgCiAgICAgICAgY29uc29sZS5sb2coYFtNR1hJU05VVkVNXSBQcm94eSByb3RhY2lvbmFkbyBwYXJhOiAke25leHRQcm94eX1gKTsKICAgICAgICAKICAgICAgICAvLyBOb3RpZmljYSBtdWRhbsOnYQogICAgICAgIHRoaXMub25Qcm94eUNoYW5nZWQobmV4dFByb3h5KTsKICAgICAgICAKICAgICAgICByZXR1cm4gbmV4dFByb3h5OwogICAgfQogICAgCiAgICAvLyBFdmVudG8gY2hhbWFkbyBxdWFuZG8gcHJveHkgbXVkYQogICAgb25Qcm94eUNoYW5nZWQocHJveHlVcmwpIHsKICAgICAgICBjb25zb2xlLmxvZyhgW01HWElTTlVWRU1dIFByb3h5IGF0aXZvOiAke3Byb3h5VXJsfWApOwogICAgICAgIAogICAgICAgIC8vIEFxdWkgdm9jw6ogcG9kZSBpbnRlZ3JhciBjb20gc2V1IHNpc3RlbWEKICAgICAgICAvLyBFeGVtcGxvOiBhdHVhbGl6YXIgdmFyacOhdmVpcyBkZSBhbWJpZW50ZSwgbm90aWZpY2FyIG91dHJvcyBzZXJ2acOnb3MsIGV0Yy4KICAgICAgICAKICAgICAgICAvLyBDb25maWd1cmEgcHJveHkgcGFyYSB1c28gZ2xvYmFsCiAgICAgICAgdGhpcy5zZXRHbG9iYWxQcm94eShwcm94eVVybCk7CiAgICB9CiAgICAKICAgIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KICAgIC8vIEZVTsOHw5VFUyBERSBVU08gUFLDgVRJQ08KICAgIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KICAgIAogICAgLy8gT2J0w6ltIHVtIHByb3h5IGZ1bmNpb25hbAogICAgYXN5bmMgZ2V0V29ya2luZ1Byb3h5KCkgewogICAgICAgIGlmICh0aGlzLndvcmtpbmdQcm94aWVzLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgLy8gUmV0b3JuYSBvIG1haXMgcsOhcGlkbwogICAgICAgICAgICByZXR1cm4gdGhpcy53b3JraW5nUHJveGllc1swXTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgLy8gU2UgbsOjbyB0aXZlciB3b3JraW5nIHByb3hpZXMsIGJ1c2NhIGUgdGVzdGEKICAgICAgICBjb25zb2xlLmxvZygnW01HWElTTlVWRU1dIEJ1c2NhbmRvIHByb3hpZXMgZnVuY2lvbmFpcy4uLicpOwogICAgICAgIGF3YWl0IHRoaXMuZmV0Y2hQcm94aWVzKCk7CiAgICAgICAgCiAgICAgICAgaWYgKHRoaXMucHJveHlMaXN0Lmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ05lbmh1bSBwcm94eSBkaXNwb27DrXZlbCcpOwogICAgICAgIH0KICAgICAgICAKICAgICAgICAvLyBUZXN0YSB1bWEgYW1vc3RyYQogICAgICAgIGNvbnN0IHNhbXBsZVNpemUgPSBNYXRoLm1pbig1MCwgdGhpcy5wcm94eUxpc3QubGVuZ3RoKTsKICAgICAgICBjb25zdCBzYW1wbGUgPSB0aGlzLnByb3h5TGlzdC5zbGljZSgwLCBzYW1wbGVTaXplKTsKICAgICAgICBhd2FpdCB0aGlzLnRlc3RNdWx0aXBsZVByb3hpZXMoc2FtcGxlKTsKICAgICAgICAKICAgICAgICBpZiAodGhpcy53b3JraW5nUHJveGllcy5sZW5ndGggPT09IDApIHsKICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdOZW5odW0gcHJveHkgZnVuY2lvbmFsIGVuY29udHJhZG8nKTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgcmV0dXJuIHRoaXMud29ya2luZ1Byb3hpZXNbMF07CiAgICB9CiAgICAKICAgIC8vIENyaWEgdW0gYWdlbnRlIEhUVFAgcGFyYSB1c28gZXh0ZXJubwogICAgY3JlYXRlQWdlbnQocHJveHlVcmwgPSBudWxsKSB7CiAgICAgICAgY29uc3QgcHJveHkgPSBwcm94eVVybCB8fCB0aGlzLmN1cnJlbnRQcm94eTsKICAgICAgICBpZiAoIXByb3h5KSB7CiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignTmVuaHVtIHByb3h5IGNvbmZpZ3VyYWRvJyk7CiAgICAgICAgfQogICAgICAgIHJldHVybiB0aGlzLmNyZWF0ZVByb3h5QWdlbnQocHJveHkpOwogICAgfQogICAgCiAgICAvLyBDb25maWd1cmEgcHJveHkgZ2xvYmFsIG5vIHNpc3RlbWEKICAgIHNldEdsb2JhbFByb3h5KHByb3h5VXJsKSB7CiAgICAgICAgLy8gQ29uZmlndXJhIHZhcmnDoXZlaXMgZGUgYW1iaWVudGUKICAgICAgICBwcm9jZXNzLmVudi5IVFRQX1BST1hZID0gcHJveHlVcmw7CiAgICAgICAgcHJvY2Vzcy5lbnYuSFRUUFNfUFJPWFkgPSBwcm94eVVybDsKICAgICAgICBwcm9jZXNzLmVudi5odHRwX3Byb3h5ID0gcHJveHlVcmw7CiAgICAgICAgcHJvY2Vzcy5lbnYuaHR0cHNfcHJveHkgPSBwcm94eVVybDsKICAgICAgICAKICAgICAgICBjb25zb2xlLmxvZyhgW01HWElTTlVWRU1dIFByb3h5IGdsb2JhbCBjb25maWd1cmFkbzogJHtwcm94eVVybH1gKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KICAgIAogICAgLy8gRmF6IHVtYSByZXF1aXNpw6fDo28gYXRyYXbDqXMgZG8gcHJveHkKICAgIGFzeW5jIG1ha2VSZXF1ZXN0KHVybCwgb3B0aW9ucyA9IHt9KSB7CiAgICAgICAgaWYgKCF0aGlzLmN1cnJlbnRQcm94eSkgewogICAgICAgICAgICBhd2FpdCB0aGlzLmdldFdvcmtpbmdQcm94eSgpOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBjb25zdCBhZ2VudCA9IHRoaXMuY3JlYXRlQWdlbnQoKTsKICAgICAgICBjb25zdCB1c2VyQWdlbnQgPSB0aGlzLmNvbmZpZy5VU0VSX0FHRU5UU1tNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiB0aGlzLmNvbmZpZy5VU0VSX0FHRU5UUy5sZW5ndGgpXTsKICAgICAgICAKICAgICAgICBjb25zdCByZXF1ZXN0T3B0aW9ucyA9IHsKICAgICAgICAgICAgaHR0cHNBZ2VudDogYWdlbnQsCiAgICAgICAgICAgIHRpbWVvdXQ6IG9wdGlvbnMudGltZW91dCB8fCB0aGlzLmNvbmZpZy5URVNUX1RJTUVPVVQsCiAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICAgICdVc2VyLUFnZW50JzogdXNlckFnZW50LAogICAgICAgICAgICAgICAgJ0FjY2VwdCc6ICdhcHBsaWNhdGlvbi9qc29uLHRleHQvaHRtbCwqLyonLAogICAgICAgICAgICAgICAgJ0FjY2VwdC1MYW5ndWFnZSc6ICdwdC1CUixwdDtxPTAuOSxlbjtxPTAuOCcsCiAgICAgICAgICAgICAgICAnQ29ubmVjdGlvbic6ICdrZWVwLWFsaXZlJywKICAgICAgICAgICAgICAgIC4uLm9wdGlvbnMuaGVhZGVycwogICAgICAgICAgICB9LAogICAgICAgICAgICAuLi5vcHRpb25zCiAgICAgICAgfTsKICAgICAgICAKICAgICAgICB0cnkgewogICAgICAgICAgICB0aGlzLnN0YXRzLnJlcXVlc3RzTWFkZSsrOwogICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGF4aW9zLmdldCh1cmwsIHJlcXVlc3RPcHRpb25zKTsKICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlOwogICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgICAgIC8vIFNlIGZhbGhhciwgdGVudGEgY29tIG91dHJvIHByb3h5CiAgICAgICAgICAgIGNvbnNvbGUubG9nKGBbTUdYSVNOVVZFTV0gUmVxdWVzdCBmYWxob3U6ICR7ZXJyb3IubWVzc2FnZX1gKTsKICAgICAgICAgICAgCiAgICAgICAgICAgIGlmICh0aGlzLmNvbmZpZy5NQVhfUkVUUklFUyA+IDApIHsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdbTUdYSVNOVVZFTV0gVGVudGFuZG8gY29tIG91dHJvIHByb3h5Li4uJyk7CiAgICAgICAgICAgICAgICB0aGlzLmJsYWNrbGlzdFByb3h5KHRoaXMuY3VycmVudFByb3h5KTsKICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucm90YXRlUHJveHkoKTsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgLy8gUmV0cnkgY29tIG5vdm8gcHJveHkKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLm1ha2VSZXF1ZXN0KHVybCwgb3B0aW9ucyk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgCiAgICAgICAgICAgIHRocm93IGVycm9yOwogICAgICAgIH0KICAgIH0KICAgIAogICAgLy8gVmVyaWZpY2EgSVAgYXR1YWwKICAgIGFzeW5jIGNoZWNrQ3VycmVudElQKCkgewogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5tYWtlUmVxdWVzdCgnaHR0cDovL2h0dHBiaW4ub3JnL2lwJyk7CiAgICAgICAgICAgIHJldHVybiByZXNwb25zZS5kYXRhOwogICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1tNR1hJU05VVkVNXSBFcnJvIGFvIHZlcmlmaWNhciBJUDonLCBlcnJvci5tZXNzYWdlKTsKICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfQogICAgfQogICAgCiAgICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiAgICAvLyBVVElMSVTDgVJJT1MgRSBHRVJFTkNJQU1FTlRPCiAgICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiAgICAKICAgIC8vIFNhbHZhIHRvZG9zIG9zIGRhZG9zCiAgICBzYXZlRGF0YSgpIHsKICAgICAgICB0aGlzLnNhdmVQcm94aWVzVG9GaWxlKCk7CiAgICAgICAgdGhpcy5zYXZlV29ya2luZ1Byb3hpZXMoKTsKICAgICAgICB0aGlzLmxvZ0FjdGl2aXR5KCdEYWRvcyBzYWx2b3MnKTsKICAgIH0KICAgIAogICAgLy8gTG9nIGRlIGF0aXZpZGFkZQogICAgbG9nQWN0aXZpdHkobWVzc2FnZSkgewogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGNvbnN0IGxvZ0ZpbGUgPSBwYXRoLmpvaW4odGhpcy5jb25maWcuREFUQV9ESVIsIHRoaXMuY29uZmlnLkZJTEVTLkxPR1MpOwogICAgICAgICAgICBjb25zdCB0aW1lc3RhbXAgPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCk7CiAgICAgICAgICAgIGNvbnN0IGxvZ01lc3NhZ2UgPSBgWyR7dGltZXN0YW1wfV0gJHttZXNzYWdlfVxuYDsKICAgICAgICAgICAgZnMuYXBwZW5kRmlsZVN5bmMobG9nRmlsZSwgbG9nTWVzc2FnZSwgJ3V0ZjgnKTsKICAgICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgICAgICBjb25zb2xlLmVycm9yKCdbTUdYSVNOVVZFTV0gRXJybyBhbyBsb2dhciBhdGl2aWRhZGU6JywgZXJyb3IubWVzc2FnZSk7CiAgICAgICAgfQogICAgfQogICAgCiAgICAvLyBNb3N0cmEgZXN0YXTDrXN0aWNhcwogICAgc2hvd1N0YXRzKCkgewogICAgICAgIGNvbnNvbGUubG9nKCdcbj09PSBFU1RBVMONU1RJQ0FTIE1HWElTTlVWRU0gPT09Jyk7CiAgICAgICAgY29uc29sZS5sb2coYFByb3hpZXMgY2FycmVnYWRvczogJHt0aGlzLnN0YXRzLnByb3hpZXNMb2FkZWR9YCk7CiAgICAgICAgY29uc29sZS5sb2coYFByb3hpZXMgdGVzdGFkb3M6ICR7dGhpcy5zdGF0cy5wcm94aWVzVGVzdGVkfWApOwogICAgICAgIGNvbnNvbGUubG9nKGBQcm94aWVzIGZ1bmNpb25hbmRvOiAke3RoaXMuc3RhdHMucHJveGllc1dvcmtpbmd9YCk7CiAgICAgICAgY29uc29sZS5sb2coYFJlcXVlc3RzIHJlYWxpemFkb3M6ICR7dGhpcy5zdGF0cy5yZXF1ZXN0c01hZGV9YCk7CiAgICAgICAgY29uc29sZS5sb2coYMOabHRpbWEgcm90YcOnw6NvOiAke3RoaXMuc3RhdHMubGFzdFJvdGF0aW9uIHx8ICdOdW5jYSd9YCk7CiAgICAgICAgY29uc29sZS5sb2coYFRlbXBvIGF0aXZvOiAke01hdGguZmxvb3IoKG5ldyBEYXRlKCkgLSB0aGlzLnN0YXRzLnN0YXJ0VGltZSkgLyA2MDAwMCl9IG1pbnV0b3NgKTsKICAgICAgICBjb25zb2xlLmxvZyhgUHJveHkgYXR1YWw6ICR7dGhpcy5jdXJyZW50UHJveHkgfHwgJ05lbmh1bSd9YCk7CiAgICAgICAgY29uc29sZS5sb2coYFJvdGHDp8OjbyBhdGl2YTogJHt0aGlzLmFjdGl2ZSA/ICdTaW0nIDogJ07Do28nfWApOwogICAgICAgIGNvbnNvbGUubG9nKCc9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4nKTsKICAgIH0KICAgIAogICAgLy8gTGltcGEgZGFkb3MgYW50aWdvcwogICAgY2xlYW51cCgpIHsKICAgICAgICBjb25zb2xlLmxvZygnW01HWElTTlVWRU1dIExpbXBhbmRvIGRhZG9zIGFudGlnb3MuLi4nKTsKICAgICAgICB0aGlzLnByb3h5TGlzdCA9IFtdOwogICAgICAgIHRoaXMud29ya2luZ1Byb3hpZXMgPSBbXTsKICAgICAgICB0aGlzLmJsYWNrbGlzdC5jbGVhcigpOwogICAgICAgIHRoaXMuY3VycmVudFByb3h5ID0gbnVsbDsKICAgICAgICAKICAgICAgICAvLyBMaW1wYSBhcnF1aXZvcwogICAgICAgIGNvbnN0IGZpbGVzID0gT2JqZWN0LnZhbHVlcyh0aGlzLmNvbmZpZy5GSUxFUyk7CiAgICAgICAgZmlsZXMuZm9yRWFjaChmaWxlbmFtZSA9PiB7CiAgICAgICAgICAgIGNvbnN0IGZpbGVQYXRoID0gcGF0aC5qb2luKHRoaXMuY29uZmlnLkRBVEFfRElSLCBmaWxlbmFtZSk7CiAgICAgICAgICAgIGlmIChmcy5leGlzdHNTeW5jKGZpbGVQYXRoKSkgewogICAgICAgICAgICAgICAgZnMud3JpdGVGaWxlU3luYyhmaWxlUGF0aCwgJycsICd1dGY4Jyk7CiAgICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgICAKICAgICAgICBjb25zb2xlLmxvZygnW01HWElTTlVWRU1dIFRvZG9zIG9zIGRhZG9zIGZvcmFtIGxpbXBvcycpOwogICAgfQp9CgovLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ci8vIEZVTsOHw4NPIFBSSU5DSVBBTCBERSBFWEVDVcOHw4NPCi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KYXN5bmMgZnVuY3Rpb24gbWFpbigpIHsKICAgIGNvbnNvbGUubG9nKCc9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PScpOwogICAgY29uc29sZS5sb2coJyAgICAgICBNR1hJU05VVkVNIC0gU2lzdGVtYSBkZSBQcm94aWVzICAgICcpOwogICAgY29uc29sZS5sb2coJz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4nKTsKICAgIAogICAgLy8gQ3JpYSBpbnN0w6JuY2lhIGRvIHNpc3RlbWEKICAgIGNvbnN0IG1neGlzID0gbmV3IE1HWElTTnV2ZW0oKTsKICAgIAogICAgLy8gRXhlbXBsbyBkZSB1c28gY29tcGxldG86CiAgICB0cnkgewogICAgICAgIC8vIDEuIEJ1c2NhIHByb3hpZXMKICAgICAgICBjb25zb2xlLmxvZygnXG5bMV0gQnVzY2FuZG8gcHJveGllcy4uLicpOwogICAgICAgIGF3YWl0IG1neGlzLmZldGNoUHJveGllcygpOwogICAgICAgIAogICAgICAgIC8vIDIuIFRlc3RhIHVtYSBhbW9zdHJhCiAgICAgICAgY29uc29sZS5sb2coJ1xuWzJdIFRlc3RhbmRvIHByb3hpZXMuLi4nKTsKICAgICAgICBjb25zdCBzYW1wbGVTaXplID0gTWF0aC5taW4oMzAsIG1neGlzLnByb3h5TGlzdC5sZW5ndGgpOwogICAgICAgIGNvbnN0IHNhbXBsZSA9IG1neGlzLnByb3h5TGlzdC5zbGljZSgwLCBzYW1wbGVTaXplKTsKICAgICAgICBhd2FpdCBtZ3hpcy50ZXN0TXVsdGlwbGVQcm94aWVzKHNhbXBsZSk7CiAgICAgICAgCiAgICAgICAgLy8gMy4gT2J0w6ltIHVtIHByb3h5IGZ1bmNpb25hbAogICAgICAgIGNvbnNvbGUubG9nKCdcblszXSBPYnRlbmRvIHByb3h5IGZ1bmNpb25hbC4uLicpOwogICAgICAgIGNvbnN0IHdvcmtpbmdQcm94eSA9IGF3YWl0IG1neGlzLmdldFdvcmtpbmdQcm94eSgpOwogICAgICAgIGNvbnNvbGUubG9nKGBQcm94eSBzZWxlY2lvbmFkbzogJHt3b3JraW5nUHJveHl9YCk7CiAgICAgICAgCiAgICAgICAgLy8gNC4gQ29uZmlndXJhIHByb3h5IGdsb2JhbAogICAgICAgIG1neGlzLnNldEdsb2JhbFByb3h5KHdvcmtpbmdQcm94eSk7CiAgICAgICAgCiAgICAgICAgLy8gNS4gVGVzdGEgbyBwcm94eSB2ZXJpZmljYW5kbyBJUAogICAgICAgIGNvbnNvbGUubG9nKCdcbls0XSBUZXN0YW5kbyBhbm9uaW1hdG8uLi4nKTsKICAgICAgICBjb25zdCBpcEluZm8gPSBhd2FpdCBtZ3hpcy5jaGVja0N1cnJlbnRJUCgpOwogICAgICAgIGNvbnNvbGUubG9nKCdJUCBhdHJhdsOpcyBkbyBwcm94eTonLCBpcEluZm8pOwogICAgICAgIAogICAgICAgIC8vIDYuIEluaWNpYSByb3Rhw6fDo28gYXV0b23DoXRpY2EgKG9wY2lvbmFsKQogICAgICAgIGlmIChtZ3hpcy5jb25maWcuQVVUT19ST1RBVElPTiAmJiBtZ3hpcy53b3JraW5nUHJveGllcy5sZW5ndGggPiAxKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdcbls1XSBJbmljaWFuZG8gcm90YcOnw6NvIGF1dG9tw6F0aWNhLi4uJyk7CiAgICAgICAgICAgIG1neGlzLnN0YXJ0Um90YXRpb24oKTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgLy8gNy4gTW9zdHJhIGVzdGF0w61zdGljYXMKICAgICAgICBtZ3hpcy5zaG93U3RhdHMoKTsKICAgICAgICAKICAgICAgICBjb25zb2xlLmxvZygnXG7inIUgU2lzdGVtYSBNR1hJU05VVkVNIG9wZXJhY2lvbmFsIScpOwogICAgICAgIGNvbnNvbGUubG9nKCdcbkNvbWFuZG9zIGRpc3BvbsOtdmVpczonKTsKICAgICAgICBjb25zb2xlLmxvZygnICDigKIgbWd4aXMuc2hvd1N0YXRzKCkgLSBNb3N0cmEgZXN0YXTDrXN0aWNhcycpOwogICAgICAgIGNvbnNvbGUubG9nKCcgIOKAoiBtZ3hpcy5yb3RhdGVQcm94eSgpIC0gTXVkYSBwcm94eSBtYW51YWxtZW50ZScpOwogICAgICAgIGNvbnNvbGUubG9nKCcgIOKAoiBtZ3hpcy5tYWtlUmVxdWVzdCh1cmwpIC0gRmF6IHJlcXVlc3QgYW7DtG5pbW8nKTsKICAgICAgICBjb25zb2xlLmxvZygnICDigKIgbWd4aXMuc3RvcFJvdGF0aW9uKCkgLSBQYXJhIHJvdGHDp8OjbyBhdXRvbcOhdGljYScpOwogICAgICAgIGNvbnNvbGUubG9nKCdcblByZXNzaW9uZSBDdHJsK0MgcGFyYSBlbmNlcnJhci5cbicpOwogICAgICAgIAogICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICBjb25zb2xlLmVycm9yKCdcbuKdjCBFcnJvIG5vIHNpc3RlbWE6JywgZXJyb3IubWVzc2FnZSk7CiAgICAgICAgcHJvY2Vzcy5leGl0KDEpOwogICAgfQp9CgovLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ci8vIEVYUE9SVEHDh8ODTyBFIEVYRUNVw4fDg08KLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoKLy8gU2UgZXhlY3V0YWRvIGRpcmV0YW1lbnRlCmlmIChyZXF1aXJlLm1haW4gPT09IG1vZHVsZSkgewogICAgbWFpbigpOwp9CgovLyBFeHBvcnRhIGEgY2xhc3NlIHBhcmEgdXNvIGNvbW8gbcOzZHVsbwptb2R1bGUuZXhwb3J0cyA9IE1HWElTTnV2ZW07Cg==`; 
const decoded = Buffer.from(codeBase64, 'base64').toString('utf8');
fs.writeFileSync('Proxies.js', decoded);
console.log('Arquivo criado: Proxies.js');
